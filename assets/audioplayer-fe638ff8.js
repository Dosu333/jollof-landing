import{V as d}from"./index-8b4b7f3d.js";const y=d("audioplayer",{state:()=>({audioplayer:new Audio,audioType:"",trackList:[{id:0,title:"",source:"",logo:"",link:"",creator:null,podcast_id:0}],currentTrack:{id:0,podcast_id:0,title:"",source:"",logo:"",link:"",creator:null},currentTrackId:0,currentTrackIndex:0,currentDuration:0,mobilePlayer:!1,playerIsUp:!1,playerIsWaiting:!1,isPlaying:!1,options:!1,playRandom:!1,playRepeat:"off",ended:!1,volume:100,muted:!1,timer:0,podcastName:""}),getters:{currentPlayingId(){return this.currentTrackId=this.currentTrack.id}},actions:{setBackgroundColor(){const a=new Image;a.crossOrigin="anonymous",a.src=this.currentTrack.logo+"?r="+Math.random()*1234,console.log(a.src),a.onload=function(){const e=document.createElement("canvas"),o=e.getContext("2d");e.width=a.width,e.height=a.height,o.drawImage(a,0,0);const s=o.getImageData(0,0,e.width,e.height).data,r={};for(let t=0;t<s.length;t+=4){const i=s[t],h=s[t+1],u=s[t+2],l=i+","+h+","+u;l in r?r[l]+=1:r[l]=1}Object.keys(r).reduce(function(t,i){return r[t]>r[i]?t:i});const n=[];for(const t in r)n.push({color:t,count:r[t]});n.sort(function(t,i){return i.count-t.count});let c="linear-gradient(to right, ";for(let t=0;t<4;t++)c+="rgb("+n[t].color+") ",c+=(t+1)/n.length*100+"%, ";c=c.slice(0,-2)+")"}},loadTrack(){this.currentDuration=0,this.audioplayer.src=this.audioType==="episode"?this.trackList[this.currentTrackIndex].source:this.trackList[this.currentTrackIndex].link,this.currentTrack=this.trackList[this.currentTrackIndex],this.currentTrack.source=this.audioType==="episode"?this.trackList[this.currentTrackIndex].source:this.trackList[this.currentTrackIndex].link,this.currentTrackId=this.trackList[this.currentTrackIndex].id,navigator.mediaSession.metadata=new MediaMetadata({title:this.currentTrack.title,artist:"Jollof Radio",album:this.currentTrack.creator?"podcast":"station",artwork:[{src:this.currentTrack.logo}]}),this.timer=0},playPauseTrack(a=!1){this.audioplayer.src!==this.trackList[this.currentTrackIndex].source&&this.audioplayer.src!==this.trackList[this.currentTrackIndex].link?(this.loadTrack(),a?this.mobilePlayer=!0:(this.isPlaying=!0,this.audioplayer.play())):this.audioplayer.paused?(this.isPlaying=!0,this.audioplayer.play()):this.audioplayer.paused||(this.isPlaying=!1,this.audioplayer.pause()),this.playerIsUp=!0},nextByBot(){this.currentDuration=0,this.currentTrackIndex<this.trackList.length-1&&this.playRepeat=="once"?(this.isPlaying=!0,this.audioplayer.play()):this.currentTrackIndex>=this.trackList.length-1&&this.playRepeat=="all"?(this.currentTrackIndex=this.playRandom?Math.round(Math.random()*this.trackList.length):0,this.loadTrack(),this.isPlaying=!0,this.audioplayer.play()):this.currentTrackIndex<this.trackList.length-1&&this.playRepeat=="all"?(this.currentTrackIndex=this.playRandom?Math.round(Math.random()*this.trackList.length):this.currentTrackIndex+1,this.loadTrack(),this.isPlaying=!0,this.audioplayer.play()):this.currentTrackIndex<this.trackList.length-1&&this.playRepeat=="off"?(this.currentTrackIndex=this.playRandom?Math.round(Math.random()*this.trackList.length):0,this.loadTrack(),this.isPlaying=!0,this.audioplayer.play()):this.currentTrackIndex>=this.trackList.length-1&&this.playRepeat=="off"&&(this.isPlaying=!1,this.audioplayer.pause())},nextTrack(){this.currentDuration=0,this.currentTrackIndex<this.trackList.length-1?(this.currentTrackIndex=this.playRandom?Math.round(Math.random()*this.trackList.length):this.currentTrackIndex+1,this.loadTrack(),this.isPlaying=!0,this.audioplayer.play()):(this.currentTrackIndex=0,this.loadTrack(),this.isPlaying=!0,this.audioplayer.play())},previousTrack(){this.currentDuration=0,this.currentTrackIndex>0?(this.currentTrackIndex=this.currentTrackIndex-1,this.loadTrack(),this.isPlaying=!0,this.audioplayer.play()):(this.currentTrackIndex=this.playRandom?Math.round(Math.random()*this.trackList.length):this.trackList.length-1,this.loadTrack(),this.isPlaying=!0,this.audioplayer.play())},setPlayerDuration(){return this.audioplayer.currentTime=this.audioplayer.duration*(this.currentDuration/100)},setVolume(){this.audioplayer.volume=this.volume/100},setMute(){this.muted=!this.muted,this.audioplayer.muted=this.muted},closePlayer(){this.isPlaying=!1,this.audioplayer.pause(),this.playerIsUp=!1}}});export{y as u};
